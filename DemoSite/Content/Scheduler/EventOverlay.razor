@using DemoApiLib.Models.ApiModels

<div class="event @Event.Eventtype.ToLower()" style="@GetEventStyle()">
    <div class="event-title">@Event.Title</div>
    <div class="event-time">@Event.StartTime.ToString("HH:mm") - @Event.EndTime.ToString("HH:mm")</div>
</div>

@code {
    [Parameter]
    public Event Event { get; set; }

    [Parameter]
    public DateOnly DayDate { get; set; }

    [Parameter]
    public int MinHour { get; set; }

    [Parameter]
    public int MaxHour { get; set; }

    private string GetEventStyle()
    {
        var dayStart = new TimeOnly(MinHour, 0);
        var dayEnd = new TimeOnly(MaxHour, 59, 59);
        var totalMinutesInView = (dayEnd - dayStart).TotalMinutes;

        var eventStart = Event.StartTime < dayStart ? dayStart : Event.StartTime;
        var eventEnd = Event.EndTime > dayEnd ? dayEnd : Event.EndTime;

        var top = ((eventStart - dayStart).TotalMinutes / totalMinutesInView) * 100;
        var height = ((eventEnd - eventStart).TotalMinutes / totalMinutesInView) * 100;

        return $"position: absolute; top: {top:F2}%; height: {height:F2}%; left: 0; right: 0;";
    }
}